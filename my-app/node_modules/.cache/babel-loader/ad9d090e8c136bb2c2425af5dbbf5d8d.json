{"ast":null,"code":"import { UrlMatcherFactory } from './url/urlMatcherFactory';\nimport { UrlRouter } from './url/urlRouter';\nimport { TransitionService } from './transition/transitionService';\nimport { ViewService } from './view/view';\nimport { StateRegistry } from './state/stateRegistry';\nimport { StateService } from './state/stateService';\nimport { UIRouterGlobals } from './globals';\nimport { values, removeFrom } from './common/common';\nimport { isFunction } from './common/predicates';\nimport { UrlService } from './url/urlService';\nimport { trace } from './common/trace';\nimport { makeStub } from './common';\n/** @internal */\n\nvar _routerInstance = 0;\n/** @internal */\n\nvar locSvcFns = ['url', 'path', 'search', 'hash', 'onChange'];\n/** @internal */\n\nvar locCfgFns = ['port', 'protocol', 'host', 'baseHref', 'html5Mode', 'hashPrefix'];\n/** @internal */\n\nvar locationServiceStub = makeStub('LocationServices', locSvcFns);\n/** @internal */\n\nvar locationConfigStub = makeStub('LocationConfig', locCfgFns);\n/**\n * An instance of UI-Router.\n *\n * This object contains references to service APIs which define your application's routing behavior.\n */\n\nvar UIRouter =\n/** @class */\nfunction () {\n  /**\n   * Creates a new `UIRouter` object\n   *\n   * @param locationService a [[LocationServices]] implementation\n   * @param locationConfig a [[LocationConfig]] implementation\n   * @internal\n   */\n  function UIRouter(locationService, locationConfig) {\n    if (locationService === void 0) {\n      locationService = locationServiceStub;\n    }\n\n    if (locationConfig === void 0) {\n      locationConfig = locationConfigStub;\n    }\n\n    this.locationService = locationService;\n    this.locationConfig = locationConfig;\n    /** @internal */\n\n    this.$id = _routerInstance++;\n    /** @internal */\n\n    this._disposed = false;\n    /** @internal */\n\n    this._disposables = [];\n    /** Enable/disable tracing to the javascript console */\n\n    this.trace = trace;\n    /** Provides services related to ui-view synchronization */\n\n    this.viewService = new ViewService(this);\n    /** An object that contains global router state, such as the current state and params */\n\n    this.globals = new UIRouterGlobals();\n    /** A service that exposes global Transition Hooks */\n\n    this.transitionService = new TransitionService(this);\n    /**\n     * Deprecated for public use. Use [[urlService]] instead.\n     * @deprecated Use [[urlService]] instead\n     */\n\n    this.urlMatcherFactory = new UrlMatcherFactory(this);\n    /**\n     * Deprecated for public use. Use [[urlService]] instead.\n     * @deprecated Use [[urlService]] instead\n     */\n\n    this.urlRouter = new UrlRouter(this);\n    /** Provides services related to the URL */\n\n    this.urlService = new UrlService(this);\n    /** Provides a registry for states, and related registration services */\n\n    this.stateRegistry = new StateRegistry(this);\n    /** Provides services related to states */\n\n    this.stateService = new StateService(this);\n    /** @internal plugin instances are registered here */\n\n    this._plugins = {};\n\n    this.viewService._pluginapi._rootViewContext(this.stateRegistry.root());\n\n    this.globals.$current = this.stateRegistry.root();\n    this.globals.current = this.globals.$current.self;\n    this.disposable(this.globals);\n    this.disposable(this.stateService);\n    this.disposable(this.stateRegistry);\n    this.disposable(this.transitionService);\n    this.disposable(this.urlService);\n    this.disposable(locationService);\n    this.disposable(locationConfig);\n  }\n  /** Registers an object to be notified when the router is disposed */\n\n\n  UIRouter.prototype.disposable = function (disposable) {\n    this._disposables.push(disposable);\n  };\n  /**\n   * Disposes this router instance\n   *\n   * When called, clears resources retained by the router by calling `dispose(this)` on all\n   * registered [[disposable]] objects.\n   *\n   * Or, if a `disposable` object is provided, calls `dispose(this)` on that object only.\n   *\n   * @internal\n   * @param disposable (optional) the disposable to dispose\n   */\n\n\n  UIRouter.prototype.dispose = function (disposable) {\n    var _this = this;\n\n    if (disposable && isFunction(disposable.dispose)) {\n      disposable.dispose(this);\n      return undefined;\n    }\n\n    this._disposed = true;\n\n    this._disposables.slice().forEach(function (d) {\n      try {\n        typeof d.dispose === 'function' && d.dispose(_this);\n        removeFrom(_this._disposables, d);\n      } catch (ignored) {}\n    });\n  };\n  /**\n   * Adds a plugin to UI-Router\n   *\n   * This method adds a UI-Router Plugin.\n   * A plugin can enhance or change UI-Router behavior using any public API.\n   *\n   * #### Example:\n   * ```js\n   * import { MyCoolPlugin } from \"ui-router-cool-plugin\";\n   *\n   * var plugin = router.addPlugin(MyCoolPlugin);\n   * ```\n   *\n   * ### Plugin authoring\n   *\n   * A plugin is simply a class (or constructor function) which accepts a [[UIRouter]] instance and (optionally) an options object.\n   *\n   * The plugin can implement its functionality using any of the public APIs of [[UIRouter]].\n   * For example, it may configure router options or add a Transition Hook.\n   *\n   * The plugin can then be published as a separate module.\n   *\n   * #### Example:\n   * ```js\n   * export class MyAuthPlugin implements UIRouterPlugin {\n   *   constructor(router: UIRouter, options: any) {\n   *     this.name = \"MyAuthPlugin\";\n   *     let $transitions = router.transitionService;\n   *     let $state = router.stateService;\n   *\n   *     let authCriteria = {\n   *       to: (state) => state.data && state.data.requiresAuth\n   *     };\n   *\n   *     function authHook(transition: Transition) {\n   *       let authService = transition.injector().get('AuthService');\n   *       if (!authService.isAuthenticated()) {\n   *         return $state.target('login');\n   *       }\n   *     }\n   *\n   *     $transitions.onStart(authCriteria, authHook);\n   *   }\n   * }\n   * ```\n   *\n   * @param plugin one of:\n   *        - a plugin class which implements [[UIRouterPlugin]]\n   *        - a constructor function for a [[UIRouterPlugin]] which accepts a [[UIRouter]] instance\n   *        - a factory function which accepts a [[UIRouter]] instance and returns a [[UIRouterPlugin]] instance\n   * @param options options to pass to the plugin class/factory\n   * @returns the registered plugin instance\n   */\n\n\n  UIRouter.prototype.plugin = function (plugin, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var pluginInstance = new plugin(this, options);\n    if (!pluginInstance.name) throw new Error('Required property `name` missing on plugin: ' + pluginInstance);\n\n    this._disposables.push(pluginInstance);\n\n    return this._plugins[pluginInstance.name] = pluginInstance;\n  };\n\n  UIRouter.prototype.getPlugin = function (pluginName) {\n    return pluginName ? this._plugins[pluginName] : values(this._plugins);\n  };\n\n  return UIRouter;\n}();\n\nexport { UIRouter };","map":{"version":3,"mappings":"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","names":["UrlMatcherFactory","UrlRouter","TransitionService","ViewService","StateRegistry","StateService","UIRouterGlobals","values","removeFrom","isFunction","UrlService","trace","makeStub","_routerInstance","locSvcFns","locCfgFns","locationServiceStub","locationConfigStub","locationService","locationConfig","viewService","_pluginapi","_rootViewContext","stateRegistry","root","globals","$current","current","self","disposable","stateService","transitionService","urlService","UIRouter","_disposables","push","dispose","undefined","_disposed","slice","forEach","d","_this","ignored","plugin","options","pluginInstance","name","Error","_plugins","pluginName"],"sources":["C:\\Users\\huang\\node_modules\\@uirouter\\core\\lib-esm\\@uirouter\\core\\router.ts"],"sourcesContent":["import { UrlMatcherFactory } from './url/urlMatcherFactory';\nimport { UrlRouter } from './url/urlRouter';\nimport { TransitionService } from './transition/transitionService';\nimport { ViewService } from './view/view';\nimport { StateRegistry } from './state/stateRegistry';\nimport { StateService } from './state/stateService';\nimport { UIRouterGlobals } from './globals';\nimport { UIRouterPlugin, Disposable } from './interface';\nimport { values, removeFrom } from './common/common';\nimport { isFunction } from './common/predicates';\nimport { UrlService } from './url/urlService';\nimport { LocationServices, LocationConfig } from './common/coreservices';\nimport { Trace, trace } from './common/trace';\nimport { makeStub } from './common';\n\n/** @internal */\nlet _routerInstance = 0;\n\n/** @internal */\nconst locSvcFns: (keyof LocationServices)[] = ['url', 'path', 'search', 'hash', 'onChange'];\n/** @internal */\nconst locCfgFns: (keyof LocationConfig)[] = ['port', 'protocol', 'host', 'baseHref', 'html5Mode', 'hashPrefix'];\n/** @internal */\nconst locationServiceStub = makeStub<LocationServices>('LocationServices', locSvcFns);\n/** @internal */\nconst locationConfigStub = makeStub<LocationConfig>('LocationConfig', locCfgFns);\n\n/**\n * An instance of UI-Router.\n *\n * This object contains references to service APIs which define your application's routing behavior.\n */\nexport class UIRouter {\n  /** @internal */ $id = _routerInstance++;\n  /** @internal */ _disposed = false;\n  /** @internal */ private _disposables: Disposable[] = [];\n\n  /** Enable/disable tracing to the javascript console */\n  trace: Trace = trace;\n\n  /** Provides services related to ui-view synchronization */\n  viewService = new ViewService(this);\n\n  /** An object that contains global router state, such as the current state and params */\n  globals: UIRouterGlobals = new UIRouterGlobals();\n\n  /** A service that exposes global Transition Hooks */\n  transitionService: TransitionService = new TransitionService(this);\n\n  /**\n   * Deprecated for public use. Use [[urlService]] instead.\n   * @deprecated Use [[urlService]] instead\n   */\n  urlMatcherFactory: UrlMatcherFactory = new UrlMatcherFactory(this);\n\n  /**\n   * Deprecated for public use. Use [[urlService]] instead.\n   * @deprecated Use [[urlService]] instead\n   */\n  urlRouter: UrlRouter = new UrlRouter(this);\n\n  /** Provides services related to the URL */\n  urlService: UrlService = new UrlService(this);\n\n  /** Provides a registry for states, and related registration services */\n  stateRegistry: StateRegistry = new StateRegistry(this);\n\n  /** Provides services related to states */\n  stateService = new StateService(this);\n\n  /** @internal plugin instances are registered here */\n  private _plugins: { [key: string]: UIRouterPlugin } = {};\n\n  /** Registers an object to be notified when the router is disposed */\n  disposable(disposable: Disposable) {\n    this._disposables.push(disposable);\n  }\n\n  /**\n   * Disposes this router instance\n   *\n   * When called, clears resources retained by the router by calling `dispose(this)` on all\n   * registered [[disposable]] objects.\n   *\n   * Or, if a `disposable` object is provided, calls `dispose(this)` on that object only.\n   *\n   * @internal\n   * @param disposable (optional) the disposable to dispose\n   */\n  dispose(disposable?: any): void {\n    if (disposable && isFunction(disposable.dispose)) {\n      disposable.dispose(this);\n      return undefined;\n    }\n\n    this._disposed = true;\n    this._disposables.slice().forEach((d) => {\n      try {\n        typeof d.dispose === 'function' && d.dispose(this);\n        removeFrom(this._disposables, d);\n      } catch (ignored) {}\n    });\n  }\n\n  /**\n   * Creates a new `UIRouter` object\n   *\n   * @param locationService a [[LocationServices]] implementation\n   * @param locationConfig a [[LocationConfig]] implementation\n   * @internal\n   */\n  constructor(\n    public locationService: LocationServices = locationServiceStub,\n    public locationConfig: LocationConfig = locationConfigStub\n  ) {\n    this.viewService._pluginapi._rootViewContext(this.stateRegistry.root());\n    this.globals.$current = this.stateRegistry.root();\n    this.globals.current = this.globals.$current.self;\n\n    this.disposable(this.globals);\n    this.disposable(this.stateService);\n    this.disposable(this.stateRegistry);\n    this.disposable(this.transitionService);\n    this.disposable(this.urlService);\n    this.disposable(locationService);\n    this.disposable(locationConfig);\n  }\n\n  /** Add plugin (as ES6 class) */\n  plugin<T extends UIRouterPlugin>(plugin: { new (router: UIRouter, options?: any): T }, options?: any): T;\n  /** Add plugin (as javascript constructor function) */\n  plugin<T extends UIRouterPlugin>(plugin: { (router: UIRouter, options?: any): void }, options?: any): T;\n  /** Add plugin (as javascript factory function) */\n  plugin<T extends UIRouterPlugin>(plugin: PluginFactory<T>, options?: any): T;\n  /**\n   * Adds a plugin to UI-Router\n   *\n   * This method adds a UI-Router Plugin.\n   * A plugin can enhance or change UI-Router behavior using any public API.\n   *\n   * #### Example:\n   * ```js\n   * import { MyCoolPlugin } from \"ui-router-cool-plugin\";\n   *\n   * var plugin = router.addPlugin(MyCoolPlugin);\n   * ```\n   *\n   * ### Plugin authoring\n   *\n   * A plugin is simply a class (or constructor function) which accepts a [[UIRouter]] instance and (optionally) an options object.\n   *\n   * The plugin can implement its functionality using any of the public APIs of [[UIRouter]].\n   * For example, it may configure router options or add a Transition Hook.\n   *\n   * The plugin can then be published as a separate module.\n   *\n   * #### Example:\n   * ```js\n   * export class MyAuthPlugin implements UIRouterPlugin {\n   *   constructor(router: UIRouter, options: any) {\n   *     this.name = \"MyAuthPlugin\";\n   *     let $transitions = router.transitionService;\n   *     let $state = router.stateService;\n   *\n   *     let authCriteria = {\n   *       to: (state) => state.data && state.data.requiresAuth\n   *     };\n   *\n   *     function authHook(transition: Transition) {\n   *       let authService = transition.injector().get('AuthService');\n   *       if (!authService.isAuthenticated()) {\n   *         return $state.target('login');\n   *       }\n   *     }\n   *\n   *     $transitions.onStart(authCriteria, authHook);\n   *   }\n   * }\n   * ```\n   *\n   * @param plugin one of:\n   *        - a plugin class which implements [[UIRouterPlugin]]\n   *        - a constructor function for a [[UIRouterPlugin]] which accepts a [[UIRouter]] instance\n   *        - a factory function which accepts a [[UIRouter]] instance and returns a [[UIRouterPlugin]] instance\n   * @param options options to pass to the plugin class/factory\n   * @returns the registered plugin instance\n   */\n  plugin<T extends UIRouterPlugin>(plugin: any, options: any = {}): T {\n    const pluginInstance = new plugin(this, options);\n    if (!pluginInstance.name) throw new Error('Required property `name` missing on plugin: ' + pluginInstance);\n    this._disposables.push(pluginInstance);\n    return (this._plugins[pluginInstance.name] = pluginInstance);\n  }\n\n  /**\n   * Returns a plugin registered with the given `pluginName`.\n   *\n   * @param pluginName the name of the plugin to get\n   * @return the plugin, or undefined\n   */\n  getPlugin(pluginName: string): UIRouterPlugin;\n  /**\n   * Returns all registered plugins\n   * @return all registered plugins\n   */\n  getPlugin(): UIRouterPlugin[];\n  getPlugin(pluginName?: string): UIRouterPlugin | UIRouterPlugin[] {\n    return pluginName ? this._plugins[pluginName] : values(this._plugins);\n  }\n}\n\n/** @internal */\nexport type PluginFactory<T> = (router: UIRouter, options?: any) => T;\n"]},"metadata":{},"sourceType":"module"}